---
title: "Using brilcalc"
teaching: 10
exercises: 20
questions:
- "What tools are available to query the delivered and recorded luminosity?"
objectives:
- "Learn how to use brilcalc to query luminosity information."
keypoints:
- "`brilcalc` is a command-line tool provided by the CMS BRIL group for querying luminosity information."
---

> ## Important
> **This exercise is meant to be run from lxplus.cern.ch.**
>
> Please follow the [setup instructions](https://delannoy.github.io/cms-das-lumi-short-exercise/setup.html) before getting started.
{: .prereq}

# brilcalc

`brilcalc` is the official tool for querying CMS luminosity information.
It currently has three subcommands: `lumi`, `beam`, and `trg`.
The official brilcalc documentation can be found here: [https://cmslumi.web.cern.ch/](https://cmslumi.web.cern.ch/).

## brilcalc lumi

This lesson will focus on the `brilcalc lumi` subcommand, which can query the delivered and recorded CMS luminosity.
Let's try a few examples:

> ## `brilcalc lumi -f "${fill}"`
> ```bash
> brilcalc lumi -f 6666
> ```
> {: .source}
> ```
> #Data tag : 19v3 , Norm tag: onlineresult
> +-------------+-------------------+------+------+---------------------+---------------------+
> | run:fill    | time              | nls  | ncms | delivered(/ub)      | recorded(/ub)       |
> +-------------+-------------------+------+------+---------------------+---------------------+
> | 316108:6666 | 05/10/18 20:54:10 | 20   | 7    | 405.423497145       | 107.184508306       |
> | 316109:6666 | 05/10/18 21:01:36 | 54   | 45   | 10039605.429211318  | 3542879.861587470   |
> | 316110:6666 | 05/10/18 21:22:27 | 217  | 210  | 84147739.992830962  | 79017103.630366772  |
> | 316111:6666 | 05/10/18 22:46:45 | 59   | 48   | 20773266.833208650  | 14573457.533706700  |
> | 316112:6666 | 05/10/18 23:09:31 | 19   | 10   | 6499507.705982770   | 228.928666450       |
> | 316113:6666 | 05/10/18 23:16:41 | 68   | 64   | 22720996.040678266  | 19663097.809963763  |
> | 316114:6666 | 05/10/18 23:42:59 | 1647 | 1647 | 371661976.624663532 | 362106384.976257861 |
> +-------------+-------------------+------+------+---------------------+---------------------+
> #Summary:
> +-------+------+------+------+---------------------+---------------------+
> | nfill | nrun | nls  | ncms | totdelivered(/ub)   | totrecorded(/ub)    |
> +-------+------+------+------+---------------------+---------------------+
> | 1     | 7    | 2084 | 2031 | 515843498.050072670 | 478903259.925057292 |
> +-------+------+------+------+---------------------+---------------------+
> ```
> {: .output}
{: .challenge}

> ## `brilcalc lumi -r "${run}"`
> ```bash
> brilcalc lumi -r 325000
> ```
> {: .source}
> ```
> #Data tag : 19v3 , Norm tag: onlineresult
> +-------------+-------------------+-----+------+---------------------+--------------------+
> | run:fill    | time              | nls | ncms | delivered(/ub)      | recorded(/ub)      |
> +-------------+-------------------+-----+------+---------------------+--------------------+
> | 325000:7324 | 10/21/18 08:03:56 | 376 | 371  | 100027429.112490401 | 95257794.416809484 |
> +-------------+-------------------+-----+------+---------------------+--------------------+
> #Summary:
> +-------+------+-----+------+---------------------+--------------------+
> | nfill | nrun | nls | ncms | totdelivered(/ub)   | totrecorded(/ub)   |
> +-------+------+-----+------+---------------------+--------------------+
> | 1     | 1    | 376 | 371  | 100027429.112490401 | 95257794.416809484 |
> +-------+------+-----+------+---------------------+--------------------+
> ```
> {: .output}
{: .challenge}

> ## Query luminosity info for fill corresponding to run `325000`
> > ## Solution
> > ```bash
> > brilcalc lumi -f 7324
> > ```
> > {: .source}
> > ```
> > #Data tag : 19v3 , Norm tag: onlineresult
> > +-------------+-------------------+-----+------+---------------------+---------------------+
> > | run:fill    | time              | nls | ncms | delivered(/ub)      | recorded(/ub)       |
> > +-------------+-------------------+-----+------+---------------------+---------------------+
> > | 324993:7324 | 10/21/18 04:13:52 | 4   | 0    | 57.418615708        | 0                   |
> > | 324997:7324 | 10/21/18 04:27:42 | 144 | 135  | 52975599.000250138  | 45212110.272690363  |
> > | 324998:7324 | 10/21/18 05:23:15 | 371 | 362  | 124730512.764399797 | 114778149.184397712 |
> > | 324999:7324 | 10/21/18 07:47:05 | 44  | 38   | 13126573.110420927  | 3909932.614611583   |
> > | 325000:7324 | 10/21/18 08:03:56 | 376 | 371  | 100027429.112490401 | 95257794.416809484  |
> > | 325001:7324 | 10/21/18 10:29:40 | 601 | 601  | 126213437.566453755 | 121487548.568495035 |
> > +-------------+-------------------+-----+------+---------------------+---------------------+
> > #Summary:
> > +-------+------+------+------+---------------------+---------------------+
> > | nfill | nrun | nls  | ncms | totdelivered(/ub)   | totrecorded(/ub)    |
> > +-------+------+------+------+---------------------+---------------------+
> > | 1     | 6    | 1540 | 1507 | 417073608.972630739 | 380645535.057004213 |
> > +-------+------+------+------+---------------------+---------------------+
> > ```
> > {: .output}
> {: .solution}
{: .challenge}
